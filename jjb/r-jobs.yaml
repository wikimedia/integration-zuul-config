- job:
    name: 'lintr-docker'
    node: DebianJessieDocker
    concurrent: true
    # Reinject Zuul parameters since JJB strip for some reason
    triggers:
     - zuul
    builders:
     - docker-zuul-env
     - docker-log-dir
     - docker-run-with-log:
        image: 'wmfreleng/lintr:v2017.09.26.12.04'
        logdir: '/log'
    wrappers:
     - timeout:
         timeout: 1 # minute
     - timestamps
     - ansicolor
    publishers:
     - postbuildscript:
        builders:
          - shell: "cat log/lintr.log | grep -q style:; test $? -eq 1"
            # Postbuild options are confusing, setting both to false ensures the script always runs.
            onsuccess: False
            onfailure: False
     - archive-log-dir