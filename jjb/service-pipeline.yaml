- job:
    name: 'trigger-service-pipeline'
    defaults: global
    node: blubber
    parameters: &service-pipeline-parameters
      - string:
          name: ZUUL_URL
      - string:
          name: ZUUL_PROJECT
      - string:
          name: ZUUL_COMMIT
      - string:
          name: ZUUL_REF
    builders:
      - trigger-builds:
        - project: service-pipeline
          current-parameters: true
          block: true
          same-node: false

- job:
    name: 'trigger-service-pipeline-test-only'
    defaults: global
    node: blubber
    parameters: *service-pipeline-parameters
    builders:
      - trigger-builds:
        - project: service-pipeline-test-only
          current-parameters: true
          block: true
          same-node: false

- job:
    name: 'trigger-service-pipeline-no-helm-test'
    defaults: global
    node: blubber
    parameters: *service-pipeline-parameters
    builders:
      - trigger-builds:
        - project: service-pipeline-no-helm-test
          current-parameters: true
          block: true
          same-node: false

- job:
    name: 'trigger-blubber-test'
    defaults: global
    node: blubber
    parameters: *service-pipeline-parameters
    builders:
      - trigger-builds:
        - project: blubber-test
          current-parameters: true
          block: true
          same-node: true

- job:
    name: 'service-pipeline'
    defaults: global
    project-type: pipeline
    parameters: *service-pipeline-parameters
    dsl: !include-raw:
      - service-pipeline-production.groovy
      - service-pipeline.groovy

- job:
    name: 'service-pipeline-no-helm-test'
    defaults: global
    project-type: pipeline
    parameters: *service-pipeline-parameters
    dsl: !include-raw:
      - service-pipeline-production-no-helm-test.groovy
      - service-pipeline.groovy

- job:
    name: 'service-pipeline-test-only'
    defaults: global
    project-type: pipeline
    parameters: *service-pipeline-parameters
    dsl: !include-raw:
      - service-pipeline-test.groovy
      - service-pipeline.groovy

- job:
    name: 'blubber-test'
    defaults: global
    project-type: pipeline
    parameters: *service-pipeline-parameters
    dsl: !include-raw:
      - blubber-test.groovy
