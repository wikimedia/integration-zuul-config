- project:
    name: '3d2png'
    jobs:
     - '{name}-npm-node-6-docker':
         docker_image_var: docker-registry.wikimedia.org/releng/npm-test-3d2png:0.1.2
     - '{name}-deploy-npm-node-6-docker':
         docker_image_var: docker-registry.wikimedia.org/releng/npm-test-3d2png:0.2.0

- project:
    name: 'change-propagation'
    jobs:
     - '{name}-npm-node-6-docker':
         docker_image_var: docker-registry.wikimedia.org/releng/npm-test-librdkafka:0.1.0
     - '{name}-deploy-npm-node-6-docker':
         docker_image_var: docker-registry.wikimedia.org/releng/npm-test-librdkafka:0.2.0

- project:
    name: chromium-render
    jobs:
     - '{name}-npm-browser-node-6-docker'
     - '{name}-deploy-npm-node-6-docker':
         docker_image_var: docker-registry.wikimedia.org/releng/npm-browser-test:0.2.0

- project:
    name: 'citoid'
    jobs:
     - '{name}-deploy-npm-node-6-docker'

- project:
    # mediawiki/services/cxserver.git
    name: 'cxserver'
    jobs:
     - '{name}-deploy-npm-node-6-docker'

- project:
    name: 'graphoid'
    jobs:
     - '{name}-npm-node-6-docker':
         docker_image_var: docker-registry.wikimedia.org/releng/npm-test-graphoid:0.1.0
     - '{name}-deploy-npm-node-6-docker':
         docker_image_var: docker-registry.wikimedia.org/releng/npm-test-graphoid:0.2.0

- project:
    name: 'kartotherian'
    jobs:
     - '{name}-npm-node-6-docker':
         docker_image_var: docker-registry.wikimedia.org/releng/npm-test-maps-service:0.1.0
     - '{name}-deploy-npm-node-6-docker':
         docker_image_var: docker-registry.wikimedia.org/releng/npm-test-maps-service:0.2.0

- project:
    name: 'mathoid'
    jobs:
     - '{name}-npm-node-6-docker':
         docker_image_var: docker-registry.wikimedia.org/releng/npm-test-mathoid:0.1.0
     - '{name}-deploy-npm-node-6-docker':
         docker_image_var: docker-registry.wikimedia.org/releng/npm-test-mathoid:0.2.0

- project:
    name: 'mobileapps'
    jobs:
     - '{name}-deploy-npm-node-6-docker'
     - 'mobileapps-periodic-test'

- project:
    name: poolcounter
    jobs:
        - '{name}-tox-docker':
            docker_image_var: docker-registry.wikimedia.org/releng/tox-poolcounter:0.1.0

- project:
    name: 'tilerator'
    jobs:
     - '{name}-npm-node-6-docker':
         docker_image_var: docker-registry.wikimedia.org/releng/npm-test-maps-service:0.1.0
     - '{name}-deploy-npm-node-6-docker':
         docker_image_var: docker-registry.wikimedia.org/releng/npm-test-maps-service:0.2.0

- project:
    name: 'trending-edits'
    jobs:
     - '{name}-npm-node-6-docker':
         docker_image_var: docker-registry.wikimedia.org/releng/npm-test-librdkafka:0.1.0
     - '{name}-deploy-npm-node-6-docker':
         docker_image_var: docker-registry.wikimedia.org/releng/npm-test-librdkafka:0.2.0

- job-template:
    name: 'mobileapps-periodic-test'
    node: DebianJessieDocker
    concurrent: true
    docker_image_var: 'docker-registry.wikimedia.org/releng/npm-test:0.3.0'
    run_args: 'periodic'
    triggers:
     - timed: '@hourly'
    parameters:
     - string:
         name: 'ZUUL_URL'
         default: 'https://phabricator.wikimedia.org/diffusion'
     - string:
         name: 'ZUUL_PROJECT'
         default: 'GMOA'
     - string:
         name: 'ZUUL_REF'
         default: 'master'
     - string:
         name: 'ZUUL_BRANCH'
         default: 'master'
    builders:
     - docker-castor-load
     - docker-src-dir
     - docker-log-dir
     - docker-ci-src-setup-simple
     - docker-run-with-log-cache-src:
        run_args: '{obj:run_args}'
        image: '{obj:docker_image_var}'
        logdir: '/log'
    publishers:
     - irc-wikimedia-ri-ci

- publisher:
    name: irc-wikimedia-ri-ci
    publishers:
     - ircbot:
        strategy: failure-and-fixed
        notify-start: false
        notify-committers: false
        notify-culprits: false
        notify-upstream: false
        notify-fixers: false
        message-type: summary
        matrix-notifier: only-parent
        channels:
         - name: '#wikimedia-ri-ci'
           notify-only: true
