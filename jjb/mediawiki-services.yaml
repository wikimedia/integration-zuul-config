- project:
    name: '3d2png'
    jobs:
     - '{name}-npm-node-6-docker':
         docker_image_var: docker-registry.wikimedia.org/releng/npm-test-3d2png:0.1.2
     - '{name}-deploy-npm-node-6-docker':
         docker_image_var: docker-registry.wikimedia.org/releng/npm-test-3d2png:0.2.0

- project:
    name: 'change-propagation'
    jobs:
     - '{name}-npm-node-6-docker':
         docker_image_var: docker-registry.wikimedia.org/releng/npm-test-librdkafka:0.1.0
     - '{name}-deploy-npm-node-6-docker':
         docker_image_var: docker-registry.wikimedia.org/releng/npm-test-librdkafka:0.2.0

- project:
    name: chromium-render
    jobs:
     - '{name}-npm-browser-node-6-docker'
     - '{name}-deploy-npm-node-6-docker':
         docker_image_var: docker-registry.wikimedia.org/releng/npm-browser-test:0.2.0

- project:
    name: 'citoid'
    jobs:
     - '{name}-deploy-npm-node-6-docker'

- project:
    # mediawiki/services/cxserver.git
    name: 'cxserver'
    jobs:
     - '{name}-deploy-npm-node-6-docker'

- project:
    name: 'graphoid'
    jobs:
     - '{name}-npm-node-6-docker':
         docker_image_var: docker-registry.wikimedia.org/releng/npm-test-graphoid:0.1.0
     - '{name}-deploy-npm-node-6-docker':
         docker_image_var: docker-registry.wikimedia.org/releng/npm-test-graphoid:0.2.0

- project:
    name: 'kartotherian'
    jobs:
     - '{name}-npm-node-6-docker':
         docker_image_var: docker-registry.wikimedia.org/releng/npm-test-maps-service:0.1.0
     - '{name}-deploy-npm-node-6-docker':
         docker_image_var: docker-registry.wikimedia.org/releng/npm-test-maps-service:0.2.0

- project:
    name: 'mathoid'
    jobs:
     - '{name}-npm-node-6-docker':
         docker_image_var: docker-registry.wikimedia.org/releng/npm-test-mathoid:0.1.0
     - '{name}-deploy-npm-node-6-docker':
         docker_image_var: docker-registry.wikimedia.org/releng/npm-test-mathoid:0.2.0

- project:
    name: 'mobileapps'
    jobs:
     - '{name}-deploy-npm-node-6-docker'

- project:
    name: 'tilerator'
    jobs:
     - '{name}-npm-node-6-docker':
         docker_image_var: docker-registry.wikimedia.org/releng/npm-test-maps-service:0.1.0
     - '{name}-deploy-npm-node-6-docker':
         docker_image_var: docker-registry.wikimedia.org/releng/npm-test-maps-service:0.2.0

- project:
    name: 'trending-edits'
    jobs:
     - '{name}-npm-node-6-docker':
         docker_image_var: docker-registry.wikimedia.org/releng/npm-test-librdkafka:0.1.0
     - '{name}-deploy-npm-node-6-docker':
         docker_image_var: docker-registry.wikimedia.org/releng/npm-test-librdkafka:0.2.0

- job-template:
    name: 'mobileapps-periodic-test'
    node: DebianJessieDocker
    concurrent: true
    triggers:
     - pollscm:
        cron: '@hourly'
    scm:
     - git:
        url: https://phabricator.wikimedia.org/diffusion/GMOA
        branches:
          - master # Hardcode to branch so pollscm works properly.
    builders:
     - shell: npm run -s periodic
    publishers:
     - irc-wikimedia-ri-ci

- publisher:
    name: irc-wikimedia-ri-ci
    publishers:
     - ircbot:
         message-type: summary-scm-fail
         channels:
             - name: '#wikimedia-ri-ci'
               notify-only: true
