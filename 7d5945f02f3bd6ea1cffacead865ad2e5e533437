{
  "comments": [
    {
      "key": {
        "uuid": "b8795bb4_9a0301ab",
        "filename": "jjb/project-pipelines.yaml",
        "patchSetId": 5
      },
      "lineNbr": 8,
      "author": {
        "id": 24
      },
      "writtenOn": "2019-05-22T12:49:35Z",
      "side": 1,
      "message": "+1",
      "revId": "7d5945f02f3bd6ea1cffacead865ad2e5e533437",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a7fbb89_36c1b78b",
        "filename": "zuul/layout.yaml",
        "patchSetId": 5
      },
      "lineNbr": 1406,
      "author": {
        "id": 24
      },
      "writtenOn": "2019-05-22T12:49:35Z",
      "side": 1,
      "message": "The publish job can not be in gate-and-submit since the job might complete execution without the change being merged.\n\nSince changes get serialized and jobs executed in more or less random number. There is no guarantee as to the order the job will be executed nor whether the change get merged. \n\nThat would no more publish it when a tag is generated.\n\nThe trigger-blubber-pipeline-test is no more running, but maybe that is now made as part of the trigger-blubber-pipeline-publish job?\n\nWith the service-pipeline-test and service-pipeline-test-and-publish, the publish steps were in the \u0027publish\u0027 and \u0027postmerge\u0027 pipeline.\n\n\nSo I think you want trigger-blubber-pipeline-test in gate-and-submit.\n\nThen have the publish variant in postmerge and publish pipelines.\n\n\n(twist for later, a Zuul template can accept a {name} placeholder that get replaced with the project basename. So theorically one could write a template such as:\n\n - name: project-pipeline\n   test:\n     - \u0027trigger-{name}-pipeline-test\n   gate-and-submit:\n     - \u0027trigger-{name}-pipeline-test\n   postmerge:\n     - \u0027trigger-{name}-pipeline-test-publish\n   publish:\n     - \u0027trigger-{name}-pipeline-test-publish\n\nAnd then use it as:\n\n - project:\n   - name: blubber\n     template:\n        - project-pipeline\n\nThe devil is one has to remember to have the related Jenkins job to be generated.  There is at least a test to ensure that jobs filled in Zuul layout are indeed generated by JJB.",
      "revId": "7d5945f02f3bd6ea1cffacead865ad2e5e533437",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    }
  ]
}