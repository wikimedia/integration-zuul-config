{
  "comments": [
    {
      "key": {
        "uuid": "57d0c5ad_06d5641a",
        "filename": "dockerfiles/mediawiki-tarball/Dockerfile.template",
        "patchSetId": 4
      },
      "lineNbr": 1,
      "author": {
        "id": 2321
      },
      "writtenOn": "2019-03-12T12:53:27Z",
      "side": 1,
      "message": "This creates the same output as:\n\n FROM {{ \u0027ci-stretch\u0027 | image_tag }}\n\nThe \"image_tag\" version has the added benefit of dynamically determining/changing the docker-pkg \"namespace\" (i.e., \"releng\") so should be preferred.",
      "revId": "f905caff6de3af51bac6a2daa55cc24a9fcac803",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5d14aae0_e08d4b75",
        "filename": "dockerfiles/mediawiki-tarball/Dockerfile.template",
        "patchSetId": 4
      },
      "lineNbr": 1,
      "author": {
        "id": 13
      },
      "writtenOn": "2019-03-13T01:38:09Z",
      "side": 1,
      "message": "I switched to this form because the form that was there resulted in \"Image docker-registry.wikimedia.org/releng/ci-stretch not found\" during the build.  Switching back now doesn\u0027t help.",
      "parentUuid": "57d0c5ad_06d5641a",
      "revId": "f905caff6de3af51bac6a2daa55cc24a9fcac803",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "030aa2e2_4b428663",
        "filename": "dockerfiles/mediawiki-tarball/Dockerfile.template",
        "patchSetId": 4
      },
      "lineNbr": 1,
      "author": {
        "id": 2321
      },
      "writtenOn": "2019-03-13T15:50:26Z",
      "side": 1,
      "message": "Interesting and confusing.\n\nFWIW I\u0027ve had success using the previous form with the invocation (using the latest version of docker-pkg):\n\n docker-pkg --no-pull --select \u0027*/*/mediawiki-tarball*\u0027 -c dockerfiles/config.yaml dockerfiles",
      "parentUuid": "5d14aae0_e08d4b75",
      "revId": "f905caff6de3af51bac6a2daa55cc24a9fcac803",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3012216f_685b6aef",
        "filename": "dockerfiles/mediawiki-tarball/Dockerfile.template",
        "patchSetId": 4
      },
      "lineNbr": 1,
      "author": {
        "id": 13
      },
      "writtenOn": "2019-03-21T18:09:54Z",
      "side": 1,
      "message": "That works.\n\nThere seems to be some path dependency that causes it to fail because when I run \"docker-pkg mediawiki-tarball\" from within the dockerfiles directory, the build succeeds with \"FROM {{ registry }}/releng/ci-stretch:latest\" and fails with \"FROM {{ \u0027ci-stretch\u0027 | image_tag }}\" with the message \"Image docker-registry.wikimedia.org/releng/ci-stretch not found\"",
      "parentUuid": "030aa2e2_4b428663",
      "revId": "f905caff6de3af51bac6a2daa55cc24a9fcac803",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "140b8837_5cd84d6b",
        "filename": "dockerfiles/mediawiki-tarball/Dockerfile.template",
        "patchSetId": 4
      },
      "lineNbr": 15,
      "author": {
        "id": 2321
      },
      "writtenOn": "2019-03-12T12:53:27Z",
      "side": 1,
      "message": "Could you put these all in one RUN line? https://www.mediawiki.org/wiki/Continuous_integration/Docker/Dockerfiles#Minimize_image_layers is a bit of explanation of why docker prefers the visually unpleasant use of one line with multiple \"\u0026\u0026\"s rather than multiple RUN lines.",
      "revId": "f905caff6de3af51bac6a2daa55cc24a9fcac803",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0e571c41_28306c48",
        "filename": "dockerfiles/mediawiki-tarball/Dockerfile.template",
        "patchSetId": 4
      },
      "lineNbr": 15,
      "author": {
        "id": 13
      },
      "writtenOn": "2019-03-13T01:38:09Z",
      "side": 1,
      "message": "Noted.  I saw the layers being created but didn\u0027t realize this was a problem until now.",
      "parentUuid": "140b8837_5cd84d6b",
      "revId": "f905caff6de3af51bac6a2daa55cc24a9fcac803",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c68fabe5_6dd33a28",
        "filename": "dockerfiles/mediawiki-tarball/changelog",
        "patchSetId": 4
      },
      "lineNbr": 1,
      "author": {
        "id": 2321
      },
      "writtenOn": "2019-03-12T12:53:27Z",
      "side": 1,
      "message": "should set the release to \"wikimedia\"",
      "revId": "f905caff6de3af51bac6a2daa55cc24a9fcac803",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "acf83c3c_2c510722",
        "filename": "dockerfiles/mediawiki-tarball/changelog",
        "patchSetId": 4
      },
      "lineNbr": 1,
      "author": {
        "id": 13
      },
      "writtenOn": "2019-03-13T01:38:09Z",
      "side": 1,
      "message": "Will do when this is ready.",
      "parentUuid": "c68fabe5_6dd33a28",
      "revId": "f905caff6de3af51bac6a2daa55cc24a9fcac803",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "dc29206e_c3604b02",
        "filename": "dockerfiles/mediawiki-tarball/changelog",
        "patchSetId": 4
      },
      "lineNbr": 5,
      "author": {
        "id": 2321
      },
      "writtenOn": "2019-03-12T12:53:27Z",
      "side": 1,
      "message": "Should only need one release per merge, unless the changelog is useful. To trick docker-pkg into rebuilding without a changelog bump you\u0027ll need to run:\n\n docker rmi docker-registry.wikimedia.org/releng/mediawiki-tarball\n\nto make docker-pkg think it needs to rebuild the image.",
      "revId": "f905caff6de3af51bac6a2daa55cc24a9fcac803",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b328cf2a_c90e8e17",
        "filename": "dockerfiles/mediawiki-tarball/changelog",
        "patchSetId": 4
      },
      "lineNbr": 5,
      "author": {
        "id": 13
      },
      "writtenOn": "2019-03-13T01:38:09Z",
      "side": 1,
      "message": "See I07ec1b810ff85e7d9c02462a4d6ae19b83a07125",
      "parentUuid": "dc29206e_c3604b02",
      "revId": "f905caff6de3af51bac6a2daa55cc24a9fcac803",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    }
  ]
}